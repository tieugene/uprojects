{% extends "sro/permit_base.html" %}
{% block main %}

<script type="text/javascript" language="JavaScript">
<!--
function GroupClicked () {
	state = document.myform.g.checked;
	items = document.myform.id;
	for (i = 0; i < items.length; i++) {
		if (items[i].checked != state) {
			items[i].checked = state;
		}
	}
}
function ItemClicked (item) {
	if (item.checked == true) {
		if (document.myform.g.checked == false) {	// if this is first item
			document.myform.g.checked = true;
		}
	}
	else {	// item off
		items = document.myform.id;
		flag = false;
		for (i = 0; i < items.length; i++) {
			if (items[i].checked == true) {
				flag = true;
				break;
			}
		}
		if ((flag == false) && (document.myform.g.checked == true)) {
			document.myform.g.checked = false;
		}
	}
}
//-->
</script>

<form name="myform" action=".#{{ id }}" method="POST">
<table border="0">
{% for s, sflag in stages %}
	<a name="{{ s.id }}"/>
	<tr {% if forloop.counter|divisibleby:2 %} bgcolor="lightgrey" {% endif %}>
		{% ifequal s.id id %}
			<td> <a href="{% url lansite.sro.views.permit_list permit.id %}#{{ s.id }}"> - </a> </td>
			<td align="center"> <input type="checkbox" name="g" {% ifequal sflag 1 %} checked {% endifequal %} onClick="GroupClicked();" /> </td>
			<td> {{ s.id }} </td>
			<td> {{ s.name }} </td>
			<td> <input type="submit" value="OK" /> </td>
		{% else %}
			<td> <a href="{% url lansite.sro.views.permit_view permit.id, s.id %}#{{ s.id }}"> + </a> </td>
			<td align="center"> {% ifequal sflag 1 %} &radic; {% endifequal %} </td>
			<td> {{ s.id }} </td>
			<td> {{ s.name }} </td>
			<td/>
		{% endifequal %}
	<tr>
	{% ifequal s.id id %}
		{% for j, jflag in jobs %}
			<tr>
				<td />
				<td align="center"> <input type="checkbox" name="id" value="{{ j.id }}" {% ifequal jflag 1 %} checked {% endifequal %} onClick="ItemClicked(this);" /> </td>
				<td> {{ j.id }} </td>
				<td> {{ j.name }} </td>
				<td/>
			<tr>
		{% endfor %}
	{% endifequal %}
{% endfor %}
</table>
</form>
{% endblock %}
